{% extends 'layouts/layout-auth.html.twig' %} {%block title%}Autentification{%endblock%}{% block body %}


<section class="box-with-image-right" id="mot-PCA">

    <div class="center">

        <div class="image height-fix" style="background-image: url( '{{asset('_assets/_img/home.jpg')}}' );">
        </div>

        <div class="content text-justify">

            <h3>Inscription</h3>
            <p>Veuillez vous inscrire en entrant les informations vous concernant.<br>
                <i class="fa fa-info-circle"></i> <b> Contactez au besoin la direction de la mutuelle pour vous communiquer votre code adhérent.</b></p>

            {% for message in app.session.flashbag.get('success') %}
            <div class="row">
                <div class="col-md-9">
                    <div class="alert alert-success" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> {{message}}
                    </div>
                </div>
            </div>
            {% endfor %} {% for message in app.session.flashbag.get('error') %}
            <div class="row">
                <div class="col-md-9">
                    <div class="alert alert-danger" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> {{message}}
                    </div>
                </div>
            </div>
            {% endfor %}
            <div class="top-50">
                <form method="post" class="form" action="{{path('action_register')}}">
                    <div class=" col-md-9">
                        <div class="row form-group">
                            <input type="text" placeholder="Entrez votre matricule" class="form-control" name="matricule" required>
                        </div>
                        <div class="row form-group">
                            <input type="text" placeholder="Entrez votre code d'adhérent" class="form-control" name="code_adherent" required>
                        </div>
                        <div class="row form-group">
                            <select id="" class="form-control" name="societe" required>
                                <option value="" disabled selected hidden>Choisissez votre entreprise</option>
                                {%for societe in societes%}
                                <option value="{{societe.libelle}}" >{{societe.libelle}}</option>
                                {%endfor%}
                            </select>
                        </div>
                        <div class="row form-group">
                            <input type="email" placeholder="Entrez votre adresse mail" class="form-control" id="mail" name="email" required>
                        </div>
                        <div class="row form-group alert alert-danger" id="msgError" hidden>
                            <span id=""></span>
                        </div>
                        <div class="row form-group">
                            <input class="btn btn-success form-control" type="submit" id="ok" value="Soumettre l'inscription" style="height: 50px;">
                        </div>
                        <div class="form-group row">
                            <p>
                                En cliquant sur <b> «Soumettre l’inscription»</b>, vous confirmez que vous acceptez les
                                <a href="#"> Conditions générales d'utilisation et notre politique de confidentialité</a> qui vous informe des modalités 
                                de traitement de vos données personnelles ainsi que de vos droits sur ces données.
                            </p>
                        </div>
                    </div>
                </form>

            </div>

        </div>

        <div class="clear">
        </div>

    </div>

</section>


{% endblock %} {% block stylesheets %}
<link href="{{ asset('assets/global/plugins/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet" id="bootstrap-css">
<script src="{{ asset('assets/global/plugins/jquery.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('assets/global/plugins/bootstrap/js/bootstrap.min.js') }}" type="text/javascript"></script>
<style>
    /*a.button.button-navy-blue {
        padding-bottom: 30px;
    }*/
    
    .section h3 {
        color: #00a045;
        font-weight: 800;
        font-size: 13px;
        margin-left: 2px;
        border-bottom: 3px solid #00a045;
        padding-bottom: 10px;
        display: inline-block;
        margin-bottom: 60px;
        text-transform: uppercase;
    }
    
    .height-fix {
        min-height: 700px;
    }
    
    .center {
        padding: 0;
    }
    .btn-success {
    color: #fff;
    background-color: #5cb85c;
    border-color: #4cae4c;
}
.btn-success:active, .btn-success.active, .open>.dropdown-toggle.btn-success {
    background-image: none;
}
.btn-success:hover, .btn-success:focus, .btn-success.focus, .btn-success:active, .btn-success.active, .open>.dropdown-toggle.btn-success {
    color: #fff;
    background-color: #449d44;
    border-color: #398439;
}
</style>


<script>
        $(document).ready(function() {
            
            var tab = [];
            "{%for s in societies %}"
                //console.log("{{s.mail}}")
                var mail = "{{s.mail}}"
               // console.log(mail);
                tab.push(mail);
                var tableau = tab;
            "{%endfor%}"

            //var tab = ["gs2e.ci", "ma2e.ci", "cie.ci", "sodeci.ci", "sga2e.ci", "ciprel.ci", "sive.ci"];
            //alert(tab2);

            $('#mail').on("blur bind change", function() {
                //console.log(tab);
                
                var split = $(this).val().toLowerCase().split("@");
                console.log(split);
    
                if (split.length == 2) {

                    if (jQuery.inArray(split[1], tableau) != -1) {

                        $(this).removeClass("error");
                        $('#msgError').show().removeClass("alert-danger").addClass("alert-success");
                        $('#msgError').html("<i class='fa fa-check'></i> Adresse mail valide.");
                        $('#ok').attr("disabled", false);
                        //console.log(split[1] + " est contenu dans le tableau");

                    } else {
                        $(this).addClass("error");
                        $('#msgError').show().removeClass("alert-success").addClass("alert-danger");
                        $('#msgError').html("<i class='fa fa-close'></i> Utilisez votre adresse mail professionnelle.");
                        $('#ok').attr("disabled", "disabled");
                        //console.log(split[1] + "Cette adresse mail n'est pas valide");
                    }
                } else {
                        $(this).addClass("error");
                        $('#msgError').show().removeClass("alert-success").addClass("alert-danger");
                        $('#msgError').html("<i class='fa fa-close'></i> Entrez une adresse mail correcte!");
                        $('#ok').attr("disabled", "disabled");
                    //console.log(split[1] + "Cette adresse email n'est pas correcte! Veuillez réessayer svp.");
                }
    
    
    
    
            })
        })
</script>

{%endblock%}
